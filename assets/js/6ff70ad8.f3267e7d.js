(self.webpackChunksonar_scala=self.webpackChunksonar_scala||[]).push([[483],{3250:function(e,t,a){"use strict";function n(e,t){return t||(t=e.slice(0)),e.raw=t,e}a.d(t,{Z:function(){return n}})},3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return p},kt:function(){return g}});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=n.createContext({}),c=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(a),g=r,m=d["".concat(i,".").concat(g)]||d[g]||u[g]||o;return a?n.createElement(m,s(s({ref:t},p),{},{components:a})):n.createElement(m,s({ref:t},p))}));function g(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=d;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:r,s[1]=l;for(var c=2;c<o;c++)s[c]=a[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},94945:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return p},metadata:function(){return u},toc:function(){return d},default:function(){return m}});var n,r=a(74034),o=a(3250),s=a(79973),l=(a(67294),a(3905)),i=a(66518),c=a(60139),p={title:"Getting Started"},u={unversionedId:"setup/getting-started",id:"setup/getting-started",isDocsHomePage:!1,title:"Getting Started",description:"For an out-of-the-box setup, you can use the following docker-compose recipe or",source:"@site/docs/setup/getting-started.mdx",sourceDirName:"setup",slug:"/setup/getting-started",permalink:"/docs/setup/getting-started",editUrl:"https://github.com/sonar-scala/website/edit/master/docs/setup/getting-started.mdx",version:"current",frontMatter:{title:"Getting Started"},sidebar:"docs",previous:{title:"Compatibility with SonarQube",permalink:"/docs/about/compatibility-with-sonarqube"},next:{title:"Sonar-scanner Properties",permalink:"/docs/setup/sonar-scanner-properties"}},d=[{value:"Quick start",id:"quick-start",children:[]},{value:"Scapegoat",id:"scapegoat",children:[]}],g={toc:d};function m(e){var t=e.components,a=(0,s.Z)(e,["components"]);return(0,l.kt)("wrapper",(0,r.Z)({},g,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"For an out-of-the-box setup, you can use the following docker-compose recipe or\na docker image with SonarQube which contains bundled sonar-scala plugin. Please\nsee ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/sonar-scala/sonar-scala-docker"},"mwz/sonar-scala-docker"),"\nfor more details or simply follow this guide."),(0,l.kt)("p",null,"Alternatively, if you already have a SonarQube instance or you don't want to use\nDocker, you can download the latest\n",(0,l.kt)("a",{parentName:"p",href:"https://github.com/sonar-scala/sonar-scala/releases"},"release")," jar into your\nSonarQube plugins folder ",(0,l.kt)("inlineCode",{parentName:"p"},"/opt/sonarqube/extensions/plugins")," and restart\nSonarQube either manually or using the update center."),(0,l.kt)("p",null,"For automating the analysis of your Scala projects, check out\n",(0,l.kt)("a",{parentName:"p",href:"https://github.com/sonar-scala/sbt-sonar"},"mwz/sbt-sonar")," sbt plugin and the\ndocumentation ",(0,l.kt)("a",{parentName:"p",href:"/docs/setup/sbt-sonar"},"here"),". Alternatively, see the\n",(0,l.kt)("a",{parentName:"p",href:"https://github.com/sonar-scala/sonar-scala/tree/master/examples"},"examples"),"\ndirectory in sonar-scala repository, which includes example projects for SBT\n",(0,l.kt)("em",{parentName:"p"},"(",(0,l.kt)("inlineCode",{parentName:"em"},"1.x"),")"),", Gradle ",(0,l.kt)("em",{parentName:"p"},"(",(0,l.kt)("inlineCode",{parentName:"em"},"5.x"),")")," and Maven ",(0,l.kt)("em",{parentName:"p"},"(",(0,l.kt)("inlineCode",{parentName:"em"},"3.x"),")")," along with basic instructions on\nhow to execute SonarQube analysis for each of those projects without sbt-sonar."),(0,l.kt)("h2",{id:"quick-start"},"Quick start"),(0,l.kt)("p",null,"Let's start off by adding the following sbt plugins to your Scala project, in\nthe ",(0,l.kt)("inlineCode",{parentName:"p"},"./project/plugins.sbt")," file:"),(0,l.kt)("code",{className:"language-scala"},(0,i.Z)(n||(n=(0,o.Z)(['\n    addSbtPlugin("org.scoverage" % "sbt-scoverage" % "1.6.1")\n    addSbtPlugin("com.github.mwz" % "sbt-sonar" % "','")\n  '])),c.f3)),(0,l.kt)("p",null,"We've added the ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/scoverage/sbt-scoverage"},"sbt-scoverage"),"\nplugin so that we can generate a coverage report and the\n",(0,l.kt)("a",{parentName:"p",href:"/docs/setup/sbt-sonar"},"sbt-sonar")," plugin to easily trigger an analysis via an sbt task."),(0,l.kt)("p",null,"Let's start a local SonarQube server for demonstration purposes."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -p 80:9000 \\\n  mwizner/sonarqube-scala-plugins:latest-full\n")),(0,l.kt)("p",null,"Once SonarQube starts up, you should see the message saying that\n",(0,l.kt)("inlineCode",{parentName:"p"},"SonarQube is up")," and the UI should be available through ",(0,l.kt)("a",{parentName:"p",href:"http://localhost."},"http://localhost.")," The\nlogin credentials are ",(0,l.kt)("inlineCode",{parentName:"p"},"admin:admin")," in case you want to browse around."),(0,l.kt)("div",{className:"alert alert--warning",role:"alert"},"Since we haven't specified an external database for SonarQube to use, it runs in a demo mode using an embedded database, which will be lost once the docker container is stopped. Please use an external database in a production environment."),(0,l.kt)("p",null,"Finally, let's execute a SonarQube scan via sbt."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"sbt -Dsonar.host.url=http://localhost \\\n  clean coverage test coverageReport sonarScan\n")),(0,l.kt)("p",null,"Once the scan completes successfully, you can navigate to\nhttp://localhost/projects to see the results."),(0,l.kt)("p",null,"This basic setup should report to SonarQube all of the useful Size, Coverage and\nTest metrics (listed ",(0,l.kt)("a",{parentName:"p",href:"/docs/about/supported-metrics"},"here"),") in addition to raising\nany Scalastyle issues that were identified in your project."),(0,l.kt)("div",{className:"alert alert--warning",role:"alert"},"Running analysis from a Windows machine is currently not supported - please use Linux or other Unix-like operating system."),(0,l.kt)("h2",{id:"scapegoat"},"Scapegoat"),(0,l.kt)("p",null,"Let's add ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/sksamuel/scapegoat"},"Scapegoat")," to our project to\nget even more useful report."),(0,l.kt)("p",null,"Add following sbt plugin to your Scala project, in the ",(0,l.kt)("inlineCode",{parentName:"p"},"./project/plugins.sbt"),"\nfile:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-scala"},'addSbtPlugin("com.sksamuel.scapegoat" % "sbt-scapegoat" % "1.1.0")\n')),(0,l.kt)("p",null,"Set the latest Scapegoat version and the format of a report generated by\nScapegoat in your ",(0,l.kt)("inlineCode",{parentName:"p"},"build.sbt")," file:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-scala"},'scapegoatVersion in ThisBuild := "1.3.9"\nscapegoatReports := Seq("xml")\n')),(0,l.kt)("p",null,"Also, to make sure your project doesn't fail to compile due to any Scapegoat\nerrors, you can temporarily override the default severity level of all the\ninspections - all Scapegoat issues will be still reported to SonarQube with the\ncorrect severity level according to the configuration in your quality profile."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-scala"},'scalacOptions in Scapegoat += "-P:scapegoat:overrideLevels:all=Warning"\n')),(0,l.kt)("p",null,"You can now run the ",(0,l.kt)("inlineCode",{parentName:"p"},"scapegoat")," task using sbt, which should generate a report\nwith all the style issues that Scapegoat identified."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"sbt scapegoat\n")),(0,l.kt)("p",null,"Once you've done that, you will need to run the ",(0,l.kt)("inlineCode",{parentName:"p"},"sonarScan")," task again to\ninclude the Scapegoat report in SonarQube analysis."),(0,l.kt)("p",null,"Here are all of the sbt tasks put together:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"sbt -Dsonar.host.url=http://localhost \\\n  clean coverage test coverageReport scapegoat sonarScan\n")))}m.isMDXComponent=!0},66518:function(e,t){"use strict";t.Z=function(e){for(var t="string"==typeof e?[e]:e.raw,a="",n=0;n<t.length;n++)a+=t[n].replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`"),n<(arguments.length<=1?0:arguments.length-1)&&(a+=arguments.length<=n+1?void 0:arguments[n+1]);var r=a.split("\n"),o=null;r.forEach((function(e){var t=e.match(/^(\s+)\S+/);if(t){var a=t[1].length;o=o?Math.min(o,a):a}})),null!==o&&(s=o,a=r.map((function(e){return" "===e[0]?e.slice(s):e})).join("\n"));var s;return a.trim().replace(/\\n/g,"\n")}},60139:function(e){"use strict";e.exports={f3:"2.3.0"}}}]);